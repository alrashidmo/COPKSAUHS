<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KSAU-HS Clinical Affairs Dashboard</title>
    <!-- Google Fonts: Poppins -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="css/style.css?v=10">
    <link rel="stylesheet" href="css/student-portal.css?v=1">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* ============================================
           LOGIN PAGE STYLES
           ============================================ */
        .login-container {
            width: 100%;
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, rgba(27, 94, 32, 0.9) 0%, rgba(13, 59, 18, 0.95) 100%),
                        url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 800"><defs><pattern id="grid" width="40" height="40" patternUnits="userSpaceOnUse"><path d="M 40 0 L 0 0 0 40" fill="none" stroke="rgba(255,255,255,0.05)" stroke-width="1"/></pattern></defs><rect width="1200" height="800" fill="url(%23grid)"/></svg>');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            position: relative;
            overflow: auto;
            z-index: 9999;
        }

        .login-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(27, 94, 32, 0.85) 0%, rgba(13, 59, 18, 0.88) 100%);
            z-index: 1;
        }

        .login-container.hidden {
            display: none !important;
        }

        .login-wrapper {
            position: relative;
            z-index: 2;
            display: flex;
            gap: 40px;
            max-width: 1200px;
            width: 100%;
            padding: 20px;
            align-items: center;
            justify-content: center;
        }

        .login-brand-section {
            flex: 1;
            color: white;
            display: flex;
            flex-direction: column;
            gap: 30px;
            max-width: 500px;
        }

        .login-logo {
            font-size: 3.5rem;
            font-weight: 700;
            line-height: 1.2;
            margin-bottom: 10px;
        }

        .login-tagline {
            font-size: 1.1rem;
            opacity: 0.9;
            line-height: 1.6;
            color: #E8F5E9;
        }

        .login-features {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin-top: 20px;
        }

        .feature-item {
            display: flex;
            gap: 15px;
            align-items: flex-start;
        }

        .feature-icon {
            font-size: 2rem;
            flex-shrink: 0;
        }

        .feature-text {
            flex: 1;
        }

        .feature-text h4 {
            margin: 0 0 5px 0;
            font-size: 1rem;
            font-weight: 600;
            color: white;
        }

        .feature-text p {
            margin: 0;
            font-size: 0.9rem;
            opacity: 0.85;
        }

        .login-form-section {
            flex: 1;
            max-width: 450px;
            width: 100%;
        }

        .login-form-card {
            background: white;
            border-radius: 15px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
        }

        .login-form-title {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--primary-green, #1B5E20);
            margin-bottom: 10px;
            text-align: center;
        }

        .login-form-subtitle {
            font-size: 0.95rem;
            color: #666;
            text-align: center;
            margin-bottom: 30px;
        }

        .login-form-group {
            margin-bottom: 20px;
        }

        .login-form-group label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: #1a1a1a;
            font-size: 0.95rem;
        }

        .login-form-group input,
        .login-form-group select {
            width: 100%;
            padding: 14px 16px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-family: inherit;
            font-size: 1rem;
            transition: all 0.3s;
        }

        .login-form-group input:focus,
        .login-form-group select:focus {
            outline: none;
            border-color: #1B5E20;
            box-shadow: 0 0 0 4px rgba(27, 94, 32, 0.1);
            background: #f9f9f9;
        }

        .login-form-group input::placeholder {
            color: #bbb;
        }

        .account-type-selector {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 25px;
        }

        .account-type-btn {
            padding: 16px;
            border: 2px solid #e0e0e0;
            background: white;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
            font-size: 0.95rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            color: #1a1a1a;
        }

        .account-type-btn:hover {
            border-color: #1B5E20;
            background: #E8F5E9;
        }

        .account-type-btn.active {
            background: #1B5E20;
            color: white;
            border-color: #1B5E20;
            box-shadow: 0 8px 20px rgba(27, 94, 32, 0.3);
        }

        .account-type-icon {
            font-size: 1.8rem;
        }

        .login-button {
            width: 100%;
            padding: 14px;
            background: linear-gradient(135deg, #1B5E20 0%, #0D3B12 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 15px;
        }

        .login-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 30px rgba(27, 94, 32, 0.4);
        }

        .login-button:active {
            transform: translateY(0);
        }

        .demo-accounts {
            background: #E8F5E9;
            border-left: 4px solid #1B5E20;
            padding: 15px;
            border-radius: 8px;
            font-size: 0.85rem;
            margin-top: 20px;
            color: #1a1a1a;
        }

        .demo-accounts strong {
            display: block;
            margin-bottom: 8px;
            color: #1B5E20;
            font-weight: 700;
        }

        .demo-account {
            margin-bottom: 8px;
            padding: 8px;
            background: white;
            border-radius: 4px;
        }

        .demo-account:last-child {
            margin-bottom: 0;
        }

        .demo-account-type {
            font-weight: 600;
            color: #1B5E20;
        }

        .demo-account-cred {
            font-size: 0.8rem;
            color: #666;
            margin-top: 3px;
            font-family: 'Courier New', monospace;
        }

        .app-container.hidden {
            display: none !important;
        }

        @media (max-width: 1024px) {
            .login-wrapper {
                flex-direction: column;
                gap: 30px;
            }

            .login-brand-section {
                max-width: 100%;
            }

            .login-form-section {
                max-width: 100%;
            }
        }

        @media (max-width: 768px) {
            .login-form-card {
                padding: 30px 20px;
            }

            .login-logo {
                font-size: 2.5rem;
            }

            .account-type-selector {
                grid-template-columns: 1fr;
            }
        }

        /* ============================================
           ADMIN HOME PAGE STYLES
           ============================================ */
        .admin-home {
            width: 100%;
            min-height: calc(100vh - 50px);
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: visible;
            z-index: 10;
            grid-column: 1 / -1;
            grid-row: 3;
        }

        .admin-home.hidden {
            display: none !important;
            min-height: 0 !important;
            height: 0 !important;
        }

        /* Hide all sidebars when admin home is showing */
        .sidebar.unit-nav.hidden {
            display: none !important;
            min-height: 0 !important;
        }

        /* Show sidebar when not hidden */
        .sidebar.unit-nav:not(.hidden) {
            display: flex !important;
            min-height: auto !important;
        }

        .admin-home-background {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            z-index: 1;
            background-image: linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.3)), 
                              url('data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 1200 800%22><rect fill=%2287CEEB%22 width=%221200%22 height=%22400%22/><rect fill=%2390EE90%22 y=%22400%22 width=%221200%22 height=%22400%22/></svg>');
        }

        .admin-home-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(27, 94, 32, 0.4) 0%, rgba(13, 59, 18, 0.3) 100%);
            z-index: 2;
        }

        .admin-home-content {
            position: relative;
            z-index: 3;
            width: 100%;
            max-width: 1000px;
            padding: 40px 20px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .admin-welcome-card {
            background: white;
            border-radius: 20px;
            padding: 50px;
            box-shadow: 0 25px 60px rgba(0, 0, 0, 0.25);
            text-align: center;
            max-width: 800px;
            backdrop-filter: blur(10px);
        }

        .admin-welcome-card h1 {
            font-size: 2.5rem;
            color: #1B5E20;
            margin: 0 0 15px 0;
            font-weight: 700;
        }

        .admin-welcome-card > p {
            font-size: 1.2rem;
            color: #666;
            margin: 0 0 5px 0;
        }

        .admin-welcome-card .subtitle {
            font-size: 1rem;
            color: #999;
            margin-bottom: 30px;
        }

        .admin-quick-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .stat-card {
            background: linear-gradient(135deg, #E8F5E9 0%, #C8E6C9 100%);
            border-radius: 12px;
            padding: 20px;
            border: 2px solid #1B5E20;
            transition: all 0.3s;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(27, 94, 32, 0.2);
        }

        .stat-card .stat-icon {
            font-size: 2.5rem;
            display: block;
            margin-bottom: 10px;
        }

        .stat-card h3 {
            margin: 10px 0 5px 0;
            font-size: 0.95rem;
            color: #1B5E20;
            font-weight: 600;
        }

        .stat-card .stat-number {
            font-size: 2rem;
            font-weight: 700;
            color: #1B5E20;
            margin: 0;
        }

        .admin-instruction {
            margin-top: 30px;
            font-size: 1.05rem;
            color: #666;
            line-height: 1.6;
            padding: 15px;
            background: #f5f5f5;
            border-radius: 8px;
            border-left: 4px solid #1B5E20;
        }

        @media (max-width: 768px) {
            .admin-welcome-card {
                padding: 30px 20px;
            }

            .admin-welcome-card h1 {
                font-size: 2rem;
            }

            .admin-quick-stats {
                grid-template-columns: 1fr 1fr;
            }
        }

    </style>
</head>

<body>
    <!-- ============================================
         LOGIN PAGE
         ============================================ -->
    <div class="login-container" id="loginContainer">
        <div class="login-wrapper">
            <!-- Brand Section -->
            <div class="login-brand-section">
                <div class="login-logo">
                    üèõÔ∏è KSAU-HS<br>
                    <span style="font-size: 1.8rem; opacity: 0.9;">College of Pharmacy</span>
                </div>
                <p class="login-tagline">
                    Streamline your academic and clinical support requests. Track progress in real-time and connect with your college departments.
                </p>

                <div class="login-features">
                    <div class="feature-item">
                        <span class="feature-icon">üìã</span>
                        <div class="feature-text">
                            <h4>Easy Request Tracking</h4>
                            <p>Submit and monitor all your requests in one place</p>
                        </div>
                    </div>
                    <div class="feature-item">
                        <span class="feature-icon">üí¨</span>
                        <div class="feature-text">
                            <h4>Direct Communication</h4>
                            <p>Chat with coordinators and get real-time updates</p>
                        </div>
                    </div>
                    <div class="feature-item">
                        <span class="feature-icon">üìä</span>
                        <div class="feature-text">
                            <h4>Analytics Dashboard</h4>
                            <p>Visualize your request metrics and performance</p>
                        </div>
                    </div>
                    <div class="feature-item">
                        <span class="feature-icon">üîí</span>
                        <div class="feature-text">
                            <h4>Secure & Reliable</h4>
                            <p>Your data is protected with role-based access</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Login Form Section -->
            <div class="login-form-section">
                <div class="login-form-card">
                    <h2 class="login-form-title">Welcome Back</h2>
                    <p class="login-form-subtitle">Sign in to access the Student Portal</p>

                    <form id="loginForm" onsubmit="event.preventDefault(); AuthSystem.handleLogin(event);">
                        <!-- Account Type Selection -->
                        <label style="display: block; margin-bottom: 12px; font-weight: 600; color: #1a1a1a; font-size: 0.95rem;">
                            Select Account Type
                        </label>
                        <div class="account-type-selector">
                            <button type="button" class="account-type-btn active" data-type="student" onclick="AuthSystem.selectAccountType('student')">
                                <span class="account-type-icon">üéì</span>
                                <span>Student Account</span>
                            </button>
                            <button type="button" class="account-type-btn" data-type="admin" onclick="AuthSystem.selectAccountType('admin')">
                                <span class="account-type-icon">üë®‚Äçüíº</span>
                                <span>Admin Account</span>
                            </button>
                        </div>

                        <!-- Student ID / Email -->
                        <div class="login-form-group">
                            <label id="idLabel">Student ID</label>
                            <input type="text" id="userId" placeholder="Enter your student ID" required>
                        </div>

                        <!-- Password -->
                        <div class="login-form-group">
                            <label>Password</label>
                            <input type="password" id="userPassword" placeholder="Enter your password" required>
                        </div>

                        <button type="submit" class="login-button">
                            <span>üîì Sign In</span>
                        </button>

                        <!-- Demo Accounts Info -->
                        <div class="demo-accounts">
                            <strong>üìå Demo Accounts</strong>
                            <div class="demo-account">
                                <span class="demo-account-type">üéì Student</span>
                                <div class="demo-account-cred">ID: 441210049 | Pass: 123456</div>
                            </div>
                            <div class="demo-account">
                                <span class="demo-account-type">üë®‚Äçüíº Admin</span>
                                <div class="demo-account-cred">ID: admin001 | Pass: admin123</div>
                            </div>
                        </div>
                        
                        <!-- Signup Link -->
                        <div style="text-align: center; margin-top: 1.5rem; padding-top: 1.5rem; border-top: 1px solid #E0E0E0;">
                            <p style="margin: 0 0 1rem 0; color: #666; font-size: 0.95rem;">New student? Request access</p>
                            <button type="button" class="login-button" style="background: linear-gradient(135deg, #2196F3 0%, #1976D2 100%);" onclick="toggleSignup()">
                                üìù Signup
                            </button>
                        </div>
                    </form>
                    
                    <!-- STUDENT SIGNUP FORM (hidden by default) -->
                    <form id="signupForm" style="display: none;">
                        <div class="login-form-title">Request Portal Access</div>
                        <div class="login-form-subtitle">Fill out the form below to request account access</div>
                        
                        <!-- Account Type Selection -->
                        <label style="display: block; margin-bottom: 12px; font-weight: 600; color: #1a1a1a; font-size: 0.95rem;">
                            Account Type
                        </label>
                        <div class="account-type-selector" style="margin-bottom: 1.5rem;">
                            <button type="button" class="account-type-btn active" data-signup-type="student" onclick="SignupForm.selectAccountType('student')" style="flex: 1;">
                                <span class="account-type-icon">üéì</span>
                                <span>Student Account</span>
                            </button>
                            <button type="button" class="account-type-btn" data-signup-type="admin" onclick="SignupForm.selectAccountType('admin')" style="flex: 1;">
                                <span class="account-type-icon">üë®‚Äçüíº</span>
                                <span>Admin Account</span>
                            </button>
                        </div>

                        <input type="hidden" id="signupAccountType" value="student">
                        
                        <div class="login-form-group">
                            <label>Full Name</label>
                            <input type="text" id="signupName" placeholder="Your full name" required>
                        </div>
                        
                        <div class="login-form-group" id="studentIdGroup">
                            <label>Student ID</label>
                            <input type="text" id="signupStudentId" placeholder="Your student ID" required>
                        </div>

                        <div class="login-form-group" id="staffIdGroup" style="display: none;">
                            <label>Staff ID</label>
                            <input type="text" id="signupStaffId" placeholder="Your staff ID">
                        </div>
                        
                        <div class="login-form-group">
                            <label>Email Address</label>
                            <input type="email" id="signupEmail" placeholder="your.email@ksauhs.edu.sa" required>
                        </div>
                        
                        <div class="login-form-group">
                            <label>Phone Number</label>
                            <input type="tel" id="signupPhone" placeholder="+966 50 XXX XXXX" required>
                        </div>
                        
                        <div class="login-form-group" id="classGroup">
                            <label>Class/Year (Preference)</label>
                            <select id="signupClass" required>
                                <option value="">Select your year...</option>
                                <option value="P1">P1 (First Year)</option>
                                <option value="P2">P2 (Second Year)</option>
                                <option value="P3">P3 (Third Year)</option>
                                <option value="P4">P4 (Final Year)</option>
                            </select>
                        </div>

                        <div class="login-form-group" id="departmentGroup" style="display: none;">
                            <label>Department</label>
                            <select id="signupDepartment" required>
                                <option value="">Select department...</option>
                                <option value="Academic">Academic Affairs</option>
                                <option value="Clinical">Clinical Affairs</option>
                                <option value="QA">Quality Assurance</option>
                                <option value="Research">Research Unit</option>
                                <option value="Alumni">Alumni Unit</option>
                                <option value="Community">Community Service</option>
                            </select>
                        </div>

                        <div class="login-form-group" id="roleGroup" style="display: none;">
                            <label>Requested Role</label>
                            <select id="signupRole" required>
                                <option value="">Select role...</option>
                                <option value="Coordinator">Coordinator</option>
                                <option value="Manager">Manager</option>
                                <option value="Director">Director</option>
                                <option value="System Admin">System Admin</option>
                            </select>
                        </div>
                        
                        <button type="button" class="login-button" style="background: linear-gradient(135deg, #4CAF50 0%, #2E7D32 100%);" onclick="submitSignup()">
                            ‚úÖ Submit Request
                        </button>
                        
                        <button type="button" class="login-button" style="background: #999; margin-top: 0.5rem;" onclick="toggleSignup()">
                            ‚Üê Back to Login
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <div class="app-container hidden" id="portalContainer">
        <!-- Admin Home Page - HIDDEN -->
        <section id="admin-home" class="admin-home">
            <div class="admin-home-background"></div>
            <div class="admin-home-overlay"></div>
            <div class="admin-home-content">
                <div class="admin-welcome-card">
                    <h1>üèõÔ∏è Welcome to Admin Portal</h1>
                    <p>King Saud Bin Abdulaziz University for Health Sciences</p>
                    <p class="subtitle">College of Pharmacy</p>
                    
                    <div class="admin-quick-stats">
                        <div class="stat-card">
                            <span class="stat-icon">üë•</span>
                            <h3>Total Students</h3>
                            <p class="stat-number">1,245</p>
                        </div>
                        <div class="stat-card">
                            <span class="stat-icon">üéØ</span>
                            <h3>Active Tickets</h3>
                            <p class="stat-number">48</p>
                        </div>
                        <div class="stat-card">
                            <span class="stat-icon">‚è±Ô∏è</span>
                            <h3>Avg Response Time</h3>
                            <p class="stat-number">2.4h</p>
                        </div>
                        <div class="stat-card">
                            <span class="stat-icon">‚úÖ</span>
                            <h3>Resolved Today</h3>
                            <p class="stat-number">12</p>
                        </div>
                    </div>

                    <p class="admin-instruction">
                        Click on the tabs above to navigate to different departments and manage the college portal.
                    </p>
                </div>
            </div>
        </section>

        <!-- Global Navigation -->
        <nav class="global-nav">
            <div class="global-nav-brand">
                <span>üèõÔ∏è</span> College of Pharmacy
            </div>
            <ul class="global-nav-menu">
                <li class="global-nav-item" id="home-nav-item">
                    <a href="#" class="global-nav-link active" data-unit="admin-home">üè† Admin Hub</a>
                </li>
                <li class="global-nav-item">
                    <a href="#" class="global-nav-link" data-unit="student-portal">üë®‚Äçüéì Student Portal</a>
                </li>
                <li class="global-nav-item">
                    <a href="#" class="global-nav-link" data-unit="academic">Academic Affairs</a>
                </li>
                <li class="global-nav-item">
                    <a href="#" class="global-nav-link" data-unit="clinical">Clinical Affairs</a>
                </li>
                <li class="global-nav-item">
                    <a href="#" class="global-nav-link" data-unit="qa">Quality Assurance Unit</a>
                </li>
                <li class="global-nav-item">
                    <a href="#" class="global-nav-link" data-unit="research">Research Unit</a>
                </li>
                <li class="global-nav-item">
                    <a href="#" class="global-nav-link" data-unit="alumni">Alumni Unit</a>
                </li>
                <li class="global-nav-item">
                    <a href="#" class="global-nav-link" data-unit="community">Community Service</a>
                </li>
            </ul>
        </nav>

        <!-- Unit Navigation (Secondary) -->
        <div class="unit-nav-container">
            <!-- Student Portal Nav (Hidden by default) -->
            <aside class="sidebar unit-nav hidden" id="nav-student-portal">
                <div class="brand">üë®‚Äçüéì Student Portal</div>
                <ul class="nav-menu">
                    <li class="nav-item">
                        <a href="#" class="nav-link" data-view="student-home" onclick="StudentPortal.renderHome(); return false;"><span class="nav-icon">üè†</span> Home</a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" data-view="student-dashboard" onclick="StudentPortal.showDashboard(); return false;"><span class="nav-icon">üìä</span> Dashboard</a>
                    </li>
                </ul>
            </aside>

            <!-- QA Unit Nav (Hidden by default) -->
            <!-- QA Unit Nav (Hidden/Removed for Redesign) -->
            <aside class="sidebar unit-nav hidden" id="nav-qa">
                <div class="brand">Quality Assurance</div>
                <!-- Content removed as it is now duplicated in the top white tab bar -->
            </aside>

            <!-- Research Unit Nav (Hidden by default) -->
            <aside class="sidebar unit-nav hidden" id="nav-research">
                <div class="brand">üî¨ Research Unit</div>
                <ul class="nav-menu">
                    <li class="nav-item">
                        <a href="#" class="nav-link" data-view="research-overview"><span class="nav-icon">üß≠</span> Overview</a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" data-view="research-publications"><span class="nav-icon">üìö</span> Publications</a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" data-view="research-projects"><span class="nav-icon">üß†</span> Projects</a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" data-view="research-irb"><span class="nav-icon">üßæ</span> IRB & Ethics</a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" data-view="research-students"><span class="nav-icon">üéì</span> Student Research</a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" data-view="research-faculty"><span class="nav-icon">üë®‚Äçüè´</span> Faculty Research</a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" data-view="research-collaboration"><span class="nav-icon">ü§ù</span> Collaboration</a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" data-view="research-recognition"><span class="nav-icon">üèÜ</span> Recognition</a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" data-view="research-analytics"><span class="nav-icon">üìä</span> Analytics</a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" data-view="research-documents"><span class="nav-icon">üìÅ</span> Documents</a>
                    </li>
                </ul>
            </aside>

            <!-- Academic Affairs Nav (Hidden by default) -->
            <aside class="sidebar unit-nav hidden" id="nav-academic">
                <div class="brand" style="padding: 1rem; border-bottom: 2px solid #f0f0f0; font-size: 1.1rem; font-weight: 700; color: #333;">Academic Affairs</div>
                <ul class="nav-menu" style="display: flex !important; flex-direction: column !important; list-style: none; padding: 0.5rem; margin: 0; gap: 0;">
                    <li class="nav-item" style="width: 100%; display: block; margin-bottom: 0; list-style: none;">
                        <a href="#" class="nav-link" data-view="academic-overview" style="display: flex !important; width: 100%; padding: 0.75rem 1rem; text-decoration: none; color: #333; align-items: center; border: none; border-left: 4px solid transparent;">
                            <span class="nav-icon" style="margin-right: 0.75rem; font-size: 1.1rem; flex-shrink: 0;">üß≠</span> Program Overview
                        </a>
                    </li>
                    <li class="nav-item" style="width: 100%; display: block; margin-bottom: 0; list-style: none;">
                        <a href="#" class="nav-link" data-view="dept-practice" style="display: flex !important; width: 100%; padding: 0.75rem 1rem; text-decoration: none; color: #333; align-items: center; border: none; border-left: 4px solid transparent;">
                            <span class="nav-icon" style="margin-right: 0.75rem; font-size: 1.1rem; flex-shrink: 0;">üíä</span> Pharmacy Practice
                        </a>
                    </li>
                    <li class="nav-item" style="width: 100%; display: block; margin-bottom: 0; list-style: none;">
                        <a href="#" class="nav-link" data-view="dept-science" style="display: flex !important; width: 100%; padding: 0.75rem 1rem; text-decoration: none; color: #333; align-items: center; border: none; border-left: 4px solid transparent;">
                            <span class="nav-icon" style="margin-right: 0.75rem; font-size: 1.1rem; flex-shrink: 0;">üî¨</span> Pharm. Sciences
                        </a>
                    </li>
                </ul>
            </aside>

            <!-- Clinical Affairs Nav (New) -->
            <aside class="sidebar unit-nav hidden" id="nav-clinical">
                <div class="brand">Clinical Affairs</div>
                <ul class="nav-menu">
                    <li class="nav-item">
                        <a href="#" class="nav-link" data-view="appe-experience-hub">
                            <span class="nav-icon">üè†</span> Home
                        </a>
                    </li>
                </ul>
            </aside>

            <!-- Alumni Unit Nav (Hidden by default) -->
            <aside class="sidebar unit-nav hidden" id="nav-alumni">
                <div class="brand">üéì Alumni Unit Dashboard</div>
                
                <!-- Program Filter -->
                <div class="program-selector">
                    <label for="alumni-program-filter" style="font-size: 0.85rem; color: var(--text-muted); margin-bottom: 0.25rem; display: block;">Program Filter:</label>
                    <select id="alumni-program-filter" class="program-dropdown">
                        <option value="all">All Programs</option>
                        <option value="bpharm">BPharm</option>
                        <option value="pharmd">PharmD</option>
                        <option value="technician">Pharmacy Technician</option>
                    </select>
                </div>

                <ul class="nav-menu">
                    <!-- Core Sections -->
                    <li class="nav-section-header">Executive Overview</li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" data-view="alumni-overview">
                            <span class="nav-icon">üß≠</span> Alumni Overview
                        </a>
                    </li>

                    <li class="nav-section-header">Alumni Management</li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" data-view="alumni-directory">
                            <span class="nav-icon">üë§</span> Alumni Directory
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" data-view="alumni-outcomes">
                            <span class="nav-icon">üìä</span> Outcomes Tracking
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" data-view="postgraduate-tracking">
                            <span class="nav-icon">üéì</span> Postgraduate & Certification
                        </a>
                    </li>

                    <li class="nav-section-header">Engagement & Programs</li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" data-view="alumni-engagement">
                            <span class="nav-icon">ü§ù</span> Engagement Tracking
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" data-view="mentorship-program">
                            <span class="nav-icon">üß†</span> Mentorship Program
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" data-view="preceptor-pipeline">
                            <span class="nav-icon">üè•</span> Preceptor & Training Sites
                        </a>
                    </li>

                    <li class="nav-section-header">Communication & Recognition</li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" data-view="alumni-events">
                            <span class="nav-icon">üìÖ</span> Events & Communication
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" data-view="alumni-achievements">
                            <span class="nav-icon">üèÜ</span> Achievements & Recognition
                        </a>
                    </li>

                    <li class="nav-section-header">Feedback & Compliance</li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" data-view="alumni-feedback">
                            <span class="nav-icon">üì£</span> Feedback & Surveys
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" data-view="alumni-documents">
                            <span class="nav-icon">üìÅ</span> Documents & Records
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" data-view="alumni-governance">
                            <span class="nav-icon">üîê</span> Data Governance & Privacy
                        </a>
                    </li>

                    <li class="nav-section-header">Advanced Analytics</li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" data-view="alumni-ecosystem">
                            <span class="nav-icon">üîÑ</span> Alumni-Student Ecosystem
                        </a>
                    </li>
                </ul>
            </aside>

            <!-- Community Service Nav (Hidden by default) -->
            <aside class="sidebar unit-nav hidden" id="nav-community">
                <div class="brand">ü§ù Community Service</div>
                <ul class="nav-menu">
                    <li class="nav-item">
                        <a href="#" class="nav-link" data-view="community-service">
                            <span class="nav-icon">üìä</span> Dashboard
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" data-view="community-requests">
                            <span class="nav-icon">üì®</span> My Requests
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" data-view="community-activities">
                            <span class="nav-icon">üìÖ</span> Activities Calendar
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" data-view="community-hours">
                            <span class="nav-icon">‚è±Ô∏è</span> Hours Tracking
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" data-view="community-certificates">
                            <span class="nav-icon">üèÖ</span> Certificates
                        </a>
                    </li>
                </ul>
            </aside>

            <!-- Clinical Affairs Nav (Active by default) -->
            <aside class="sidebar unit-nav hidden" id="nav-clinical">
                <div class="brand">
                    <span>üéì</span> Clinical Affairs
                </div>

                <!-- Program Selector -->
                <div class="program-selector">
                    <label for="program-dropdown" style="font-size: 0.85rem; color: var(--text-muted); margin-bottom: 0.25rem; display: block;">Select Program:</label>
                    <select id="program-dropdown" class="program-dropdown">
                        <option value="pharmd">PharmD Program</option>
                        <option value="pharmacy-tech">Pharmacy Technician</option>
                    </select>
                </div>

                <!-- Location Filter (shown only for Pharmacy Technician) -->
                <div class="location-filter hidden" id="location-filter">
                    <label for="location-dropdown" style="font-size: 0.85rem; color: var(--text-muted); margin-bottom: 0.25rem; display: block;">Select Campus:</label>
                    <select id="location-dropdown" class="program-dropdown">
                        <option value="all">All Campuses</option>
                        <option value="riyadh">Riyadh</option>
                        <option value="jeddah">Jeddah</option>
                    </select>
                </div>

                <ul class="nav-menu">
                    <li class="nav-item">
                        <a href="#" class="nav-link active" data-view="home">
                            <span class="nav-icon">üè†</span> Home
                        </a>
                    </li>

                    <!-- PharmD Program Rotations -->
                    <li class="nav-section-header">
                        PharmD Rotations
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" data-view="ippe1" data-program="pharmd">
                            <span class="nav-icon">1Ô∏è‚É£</span> IPPE I
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" data-view="ippe2" data-program="pharmd">
                            <span class="nav-icon">2Ô∏è‚É£</span> IPPE II
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" data-view="ippe3" data-program="pharmd">
                            <span class="nav-icon">3Ô∏è‚É£</span> IPPE III
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" data-view="appe-experience-hub" data-program="pharmd">
                            <span class="nav-icon">üéì</span> APPE Experience Hub
                        </a>
                    </li>

                    <!-- Pharmacy Technician Navigation (Hidden by default) -->
                    <div class="program-nav hidden" id="pharmacy-tech-nav">
                        <li class="nav-section-header">
                            Pharmacy Technician Rotations
                        </li>
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-view="ipte1" data-program="pharmacy-tech">
                                <span class="nav-icon">1Ô∏è‚É£</span> IPTE I
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-view="ipte2" data-program="pharmacy-tech">
                                <span class="nav-icon">2Ô∏è‚É£</span> IPTE II
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-view="ipte3" data-program="pharmacy-tech">
                                <span class="nav-icon">3Ô∏è‚É£</span> IPTE III
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-view="apte" data-program="pharmacy-tech">
                                <span class="nav-icon">üéì</span> APTE
                            </a>
                        </li>
                    </div>

                    <!-- Student Portal Section -->
                    <li class="nav-section-header">
                        Student Portal
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" data-view="student-awards">
                            <span class="nav-icon">üèÜ</span> Student Awards
                        </a>
                    </li>

                    <!-- Management Section -->
                    <li class="nav-section-header">
                        Management
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" data-view="students">
                            <span class="nav-icon">üë•</span> Students DB
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" data-view="rotations">
                            <span class="nav-icon">üìÖ</span> Rotations
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" data-view="preceptors">
                            <span class="nav-icon">üë®‚Äç‚öïÔ∏è</span> Preceptors
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" data-view="outcomes">
                            <span class="nav-icon">üéØ</span> Outcomes
                        </a>
                    </li>
                </ul>
                <div class="user-profile-mini"
                    style="display: flex; align-items: center; gap: 10px; margin-left: auto;">
                    <small style="opacity: 0.7;">Logged in as</small>
                    <div><strong>Dr. Admin</strong></div>
                </div>
            </aside>
        </div>

        <!-- Main Content -->
        <main class="main-content">
            <header class="top-bar">
                <h1 class="page-title" id="page-title">Program Overview</h1>
                <div class="user-actions">
                    <button class="btn btn-outline" onclick="StudentPortal.switchUserRole('student')">üéì Student Mode</button>
                    <button class="btn btn-outline" onclick="StudentPortal.switchUserRole('admin')">üë®‚Äçüíº Admin Mode</button>
                    <button class="btn btn-outline">üîî Notifications</button>
                    <button class="btn btn-primary">Export Data</button>
                </div>
            </header>

            <div class="content-area" id="app-root">
                <!-- Content will be injected here by JS -->
            </div>
        </main>
    </div>

    <!-- Application Scripts -->
    <script src="js/student-portal.js?v=1" onerror="console.error('Failed to load: student-portal.js')"></script>
    <script src="js/alumni-data.js?v=20260120019" onerror="console.error('Failed to load: alumni-data.js')"></script>
    <script src="js/research-data.js?v=20260120019" onerror="console.error('Failed to load: research-data.js')"></script>
    <script src="js/appe-hub_backup_20260119_220628.js?v=20260124001" onerror="console.error('Failed to load: appe-hub backup')"></script>
    <script src="js/admin-hub-model.js?v=20260131010" onerror="console.error('Failed to load: admin-hub-model.js')"></script>
    <script src="js/app.js?v=20260131010" onerror="console.error('Failed to load: app.js')"></script>
    <script src="js/student-portal.js?v=20260131010" onerror="console.error('Failed to load: student-portal.js v2')"></script>
    <script src="js/program-switcher.js?v=1" onerror="console.error('Failed to load: program-switcher.js')"></script>
    <script src="js/outcomes-dashboard.js?v=1" onerror="console.error('Failed to load: outcomes-dashboard.js')"></script>
    <script src="js/evaluation-system.js?v=1" onerror="console.error('Failed to load: evaluation-system.js')"></script>
    <script src="js/attendance-schedule.js?v=1" onerror="console.error('Failed to load: attendance-schedule.js')"></script>
    <script src="js/matching-algorithm.js?v=1" onerror="console.error('Failed to load: matching-algorithm.js')"></script>
    <script>
        // ============================================
        // AUTHENTICATION SYSTEM
        // ============================================
        const AuthSystem = {
            currentUser: null,
            currentUserRole: null,
            currentUserName: null,
            selectedAccountType: 'student',

            // Demo accounts
            accounts: {
                student: {
                    '441210049': '123456',
                    '441210050': '123456',
                    '441210051': '123456'
                },
                admin: {
                    'admin001': 'admin123',
                    'admin002': 'admin123'
                }
            },

            // Student names mapped to IDs
            studentNames: {
                '441210049': 'Hana Al-Malik',
                '441210050': 'Omar Al-Mansour',
                '441210051': 'Sarah Al-Mutairi'
            },

            // Admin names mapped to IDs
            adminNames: {
                'admin001': 'Dr. Khalid Al-Rashid',
                'admin002': 'Dr. Noor Al-Qahtani'
            },

            // Select account type (Student or Admin)
            selectAccountType(type) {
                this.selectedAccountType = type;
                
                // Update UI
                document.querySelectorAll('.account-type-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
                document.querySelector(`[data-type="${type}"]`).classList.add('active');
                
                // Update label
                const idLabel = document.getElementById('idLabel');
                const userIdInput = document.getElementById('userId');
                if (type === 'admin') {
                    idLabel.textContent = 'Admin ID';
                    userIdInput.placeholder = 'Enter admin ID';
                } else {
                    idLabel.textContent = 'Student ID';
                    userIdInput.placeholder = 'Enter your student ID';
                }
            },

            // Handle login
            handleLogin(event) {
                event.preventDefault();
                
                const userId = document.getElementById('userId').value.trim();
                const password = document.getElementById('userPassword').value.trim();
                const accountType = this.selectedAccountType;

                // Validate credentials
                if (this.validateCredentials(userId, password, accountType)) {
                    this.currentUser = userId;
                    this.currentUserRole = accountType;
                    
                    // Get user name
                    const namesMap = accountType === 'admin' ? this.adminNames : this.studentNames;
                    this.currentUserName = namesMap[userId] || userId;
                    
                    console.log('‚úÖ Login successful:', { 
                        id: this.currentUser, 
                        role: this.currentUserRole, 
                        name: this.currentUserName 
                    });
                    
                    this.showPortal();
                    this.applyRoleBasedAccess();
                } else {
                    alert('‚ùå Invalid credentials. Please check your ID and password.\n\nDemo credentials:\nStudent: 441210049 / 123456\nAdmin: admin001 / admin123');
                    document.getElementById('userPassword').value = '';
                }
            },

            // Validate credentials
            validateCredentials(userId, password, accountType) {
                const accountList = this.accounts[accountType];
                const isValid = accountList && accountList[userId] === password;
                console.log(`Auth attempt: ${accountType} / ${userId} / ${password} = ${isValid}`);
                console.log('Available accounts:', this.accounts[accountType]);
                return isValid;
            },

            // Show portal after login
            showPortal() {
                document.getElementById('loginContainer').classList.add('hidden');
                document.getElementById('portalContainer').classList.remove('hidden');
                
                // Initialize the app for all users
                if (typeof initializeApp === 'function') {
                    initializeApp();
                }
                
                // Ensure app is ready
                if (window.appStore && !window.app) {
                    window.app = new App();
                }
            },

            // Apply role-based access control
            applyRoleBasedAccess() {
                const globalNav = document.querySelector('.global-nav');
                if (!globalNav) return;

                // Get all navigation tabs (direct links)
                const navLinks = globalNav.querySelectorAll('.global-nav-link');

                if (this.currentUserRole === 'student') {
                    // Hide all tabs except Student Portal
                    navLinks.forEach(tab => {
                        const unit = tab.getAttribute('data-unit');
                        const parent = tab.closest('.global-nav-item');
                        if (unit === 'student-portal') {
                            parent.style.display = 'block';
                        } else {
                            parent.style.display = 'none';
                        }
                    });
                    
                    // Hide admin home nav item
                    const homeNavItem = document.getElementById('home-nav-item');
                    if (homeNavItem) {
                        homeNavItem.style.display = 'none';
                    }
                    
                    // Hide admin home section
                    const adminHome = document.getElementById('admin-home');
                    if (adminHome) {
                        adminHome.classList.add('hidden');
                    }
                    
                    // Automatically click Student Portal tab
                    const studentPortalTab = globalNav.querySelector('[data-unit="student-portal"]');
                    if (studentPortalTab) {
                        studentPortalTab.click();
                    }
                } else {
                    // Show all tabs for admin
                    navLinks.forEach(tab => {
                        const parent = tab.closest('.global-nav-item');
                        parent.style.display = 'block';
                    });
                    
                    // Show home nav item
                    const homeNavItem = document.getElementById('home-nav-item');
                    if (homeNavItem) {
                        homeNavItem.style.display = 'block';
                    }
                    
                    // For admin, automatically click Admin Hub tab
                    const adminHubTab = globalNav.querySelector('[data-unit="admin-home"]');
                    if (adminHubTab) {
                        adminHubTab.click();
                    }
                }

                // Add logout button to top bar
                this.addLogoutButton();
            },

            // Show admin home page
            showAdminHome() {
                // Hide all sidebars
                document.querySelectorAll('.sidebar.unit-nav').forEach(s => s.classList.add('hidden'));
                
                // Hide app-root content
                const appRoot = document.getElementById('app-root');
                if (appRoot) {
                    appRoot.style.display = 'none';
                }

                // Show the admin home section
                const adminHome = document.getElementById('admin-home');
                if (adminHome) {
                    adminHome.classList.remove('hidden');
                    adminHome.style.display = 'flex';
                }

                // Update page title
                const pageTitle = document.getElementById('page-title');
                if (pageTitle) {
                    pageTitle.textContent = 'Welcome to Admin Portal';
                }

                // Activate home nav link
                document.querySelectorAll('.global-nav-link').forEach(link => {
                    link.classList.remove('active');
                });
                document.querySelector('[data-unit="admin-home"]')?.classList.add('active');
            },

            // Add logout button
            addLogoutButton() {
                let logoutBtn = document.getElementById('logoutBtn');
                if (logoutBtn) {
                    logoutBtn.remove();
                }

                const topBar = document.querySelector('.top-bar');
                if (!topBar) return;

                const logoutHTML = `
                    <div style="position: absolute; right: 20px; top: 15px; display: flex; align-items: center; gap: 15px;">
                        <span style="color: #666; font-size: 0.9rem;">
                            üë§ <strong>${this.currentUserName || this.currentUser}</strong> (${this.currentUserRole === 'admin' ? 'Admin' : 'Student'})
                        </span>
                        <button id="logoutBtn" style="
                            background: linear-gradient(135deg, #c62828 0%, #8b0000 100%);
                            color: white;
                            border: none;
                            padding: 8px 16px;
                            border-radius: 6px;
                            cursor: pointer;
                            font-weight: 600;
                            font-size: 0.9rem;
                            transition: all 0.3s;
                        " onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 8px 15px rgba(198, 40, 40, 0.4)'" 
                           onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none'"
                           onclick="AuthSystem.logout()">
                            üö™ Sign Out
                        </button>
                    </div>
                `;

                topBar.insertAdjacentHTML('beforeend', logoutHTML);
            },

            // Logout
            logout() {
                if (confirm('Are you sure you want to sign out?')) {
                    this.currentUser = null;
                    this.currentUserRole = null;
                    this.currentUserName = null;
                    document.getElementById('loginContainer').classList.remove('hidden');
                    document.getElementById('portalContainer').classList.add('hidden');
                    document.getElementById('userId').value = '';
                    document.getElementById('userPassword').value = '';
                    document.querySelectorAll('.account-type-btn').forEach(btn => btn.classList.remove('active'));
                    document.querySelector('[data-type="student"]').classList.add('active');
                    this.selectAccountType('student');
                }
            }
        };

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            // Show login by default
            document.getElementById('loginContainer').classList.remove('hidden');
            document.getElementById('portalContainer').classList.add('hidden');
            
            // Hook into Clinical Affairs APPE Hub link
            const appeHubLink = document.querySelector('.nav-link[data-view="appe-experience-hub"]');
            if (appeHubLink && typeof showAPPEHub === 'function') {
                appeHubLink.addEventListener('click', function(e) {
                    e.preventDefault();
                    document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
                    this.classList.add('active');
                    showAPPEHub();
                });
            }

            // Set admin home background
            const adminHomeBg = document.querySelector('.admin-home-background');
            if (adminHomeBg) {
                adminHomeBg.style.background = 'linear-gradient(135deg, #87CEEB 0%, #B0E0E6 25%, #F5DEB3 50%, #D2B48C 75%, #90EE90 100%)';
                adminHomeBg.style.backgroundAttachment = 'fixed';
            }
        });
        
        // SIGNUP FORM HANDLER
        const SignupForm = {
            currentType: 'student',

            selectAccountType(type) {
                this.currentType = type;
                document.getElementById('signupAccountType').value = type;
                
                // Update button styles
                document.querySelectorAll('[data-signup-type]').forEach(btn => btn.classList.remove('active'));
                document.querySelector(`[data-signup-type="${type}"]`).classList.add('active');
                
                // Show/hide relevant fields
                const isStudent = type === 'student';
                document.getElementById('studentIdGroup').style.display = isStudent ? 'block' : 'none';
                document.getElementById('staffIdGroup').style.display = isStudent ? 'none' : 'block';
                document.getElementById('classGroup').style.display = isStudent ? 'block' : 'none';
                document.getElementById('departmentGroup').style.display = isStudent ? 'none' : 'block';
                document.getElementById('roleGroup').style.display = isStudent ? 'none' : 'block';
                
                // Update required fields
                document.getElementById('signupStudentId').required = isStudent;
                document.getElementById('signupClass').required = isStudent;
                document.getElementById('signupStaffId').required = !isStudent;
                document.getElementById('signupDepartment').required = !isStudent;
                document.getElementById('signupRole').required = !isStudent;
                
                console.log('‚úÖ Signup type changed to:', type);
            }
        };
        
        function toggleSignup() {
            const loginForm = document.getElementById('loginForm');
            const signupForm = document.getElementById('signupForm');
            
            loginForm.style.display = loginForm.style.display === 'none' ? 'block' : 'none';
            signupForm.style.display = signupForm.style.display === 'none' ? 'block' : 'none';
            
            // Reset signup form when toggling
            if (signupForm.style.display !== 'none') {
                SignupForm.currentType = 'student';
                SignupForm.selectAccountType('student');
            }
        }
        
        function submitSignup() {
            const accountType = document.getElementById('signupAccountType').value;
            const name = document.getElementById('signupName').value;
            const email = document.getElementById('signupEmail').value;
            const phone = document.getElementById('signupPhone').value;
            
            // Validate common fields
            if (!name || !email || !phone) {
                alert('‚ö†Ô∏è Please fill in all required fields');
                return;
            }
            
            // Validate email format
            const emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailPattern.test(email)) {
                alert('‚ö†Ô∏è Please enter a valid email address');
                return;
            }
            
            let signupRequest;
            
            if (accountType === 'student') {
                const studentId = document.getElementById('signupStudentId').value;
                const classYear = document.getElementById('signupClass').value;
                
                if (!studentId || !classYear) {
                    alert('‚ö†Ô∏è Please fill in all required fields');
                    return;
                }
                
                signupRequest = {
                    id: 'signup' + Date.now(),
                    accountType: 'student',
                    studentId: studentId,
                    name: name,
                    email: email,
                    phone: phone,
                    requestedAt: new Date(),
                    status: 'pending',
                    classPreference: classYear
                };
            } else {
                const staffId = document.getElementById('signupStaffId').value;
                const department = document.getElementById('signupDepartment').value;
                const role = document.getElementById('signupRole').value;
                
                if (!staffId || !department || !role) {
                    alert('‚ö†Ô∏è Please fill in all required fields');
                    return;
                }
                
                signupRequest = {
                    id: 'signup' + Date.now(),
                    accountType: 'admin',
                    staffId: staffId,
                    name: name,
                    email: email,
                    phone: phone,
                    requestedAt: new Date(),
                    status: 'pending',
                    department: department,
                    role: role
                };
            }
            
            // In a real app, this would send to server. For now, store in localStorage
            let signups = JSON.parse(localStorage.getItem('pendingSignups') || '[]');
            signups.push(signupRequest);
            localStorage.setItem('pendingSignups', JSON.stringify(signups));
            
            // Clear form and show success message
            document.getElementById('signupForm').reset();
            const typeLabel = accountType === 'student' ? 'üéì Student' : 'üë®‚Äçüíº Admin';
            const idField = accountType === 'student' ? `Student ID: ${signupRequest.studentId}` : `Staff ID: ${signupRequest.staffId}`;
            
            alert(`‚úÖ Success!\n\nYour ${typeLabel} access request has been submitted.\n\nName: ${name}\n${idField}\n\nYour access will be approved by a system admin.\nYou'll receive an email at ${email} once approved.`);
            
            // Switch back to login
            toggleSignup();
            
            console.log('‚úÖ Signup submitted:', signupRequest);
        }
    </script>
</body>

</html>